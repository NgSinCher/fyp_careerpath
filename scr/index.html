<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BaZi Career Advisor AI - FYP Ultimate</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.2.37/lunar.js"></script>

    <style>
        body { background-color: #f0f2f5; font-family: 'Segoe UI', Roboto, sans-serif; }
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            border-radius: 20px;
        }
        /* Â∞ÅÈù¢‰∏ìÁî®ÁöÑÊ∑±Ëâ≤ÊØõÁéªÁíÉ */
        .glass-card-dark {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
        }
        .animate-fade-in { animation: fadeIn 1s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* ÂÖÉÁ¥†È¢úËâ≤ */
        .wood-text { color: #4caf50; } .fire-text { color: #f44336; }
        .earth-text { color: #ff9800; } .metal-text { color: #757575; }
        .water-text { color: #2196f3; }
    </style>
</head>
<body class="p-4 md:p-6 min-h-screen text-slate-800 bg-slate-100">

    <div class="max-w-6xl mx-auto">

        <div class="relative bg-cover bg-center h-[400px] md:h-[500px] rounded-3xl overflow-hidden mb-10 shadow-2xl animate-fade-in" 
             style="background-image: url('https://images.unsplash.com/photo-1535320903710-d993d3d77d29?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');">
            
            <div class="absolute inset-0 bg-gradient-to-b from-slate-900/70 to-indigo-900/80"></div>
            
            <div class="relative z-10 flex flex-col justify-center items-center h-full text-center text-white p-6 space-y-6">
                
                <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-blue-200 to-purple-300">
                    BaZi Career AI
                </h1>
                
                <p class="text-lg md:text-xl text-blue-100 max-w-2xl font-light">
                    Decoding Success Genes through Machine Learning & Ancient Wisdom.
                </p>
                
                <div class="glass-card-dark p-6 mt-4 flex flex-col items-center border-t-4 border-amber-400">
                    <span class="text-5xl md:text-6xl font-black text-amber-400" style="text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);">306</span>
                    <span class="text-sm md:text-base uppercase tracking-widest font-semibold mt-2 text-amber-100">
                        Billionaires Analyzed
                    </span>
                </div>
                
                <p class="text-xs text-slate-400 mt-4">FYP Project Showcase | AI-Driven Career Path & Profiling System</p>
            </div>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <div class="lg:col-span-4 glass-card p-6 h-fit animate-fade-in" style="animation-delay: 0.2s;">
                <h2 class="text-xl font-bold mb-6 flex items-center text-slate-700">
                    <span class="bg-indigo-100 text-indigo-600 py-1 px-3 rounded-full text-sm mr-2">Start Here</span> 
                    Personal Profile
                </h2>

                <form id="baziForm" onsubmit="event.preventDefault(); analyzeProfile();" class="space-y-5">
                    
                    <div>
                        <label class="block text-sm font-semibold text-slate-600 mb-1">Date of Birth (Âá∫ÁîüÊó•Êúü)</label>
                        <input type="date" id="birthDate" required class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition bg-white/50">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-slate-600 mb-1">Time of Birth (Âá∫ÁîüÊó∂Èó¥)</label>
                        <input type="time" id="birthTime" required class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-indigo-500 outline-none bg-white/50">
                        <p class="text-xs text-slate-400 mt-1">*ÂáÜÁ°ÆÁöÑÊó∂Èó¥ÂØπÊó∂Êü±ÂàÜÊûêËá≥ÂÖ≥ÈáçË¶Å</p>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-slate-600 mb-2">Gender (ÊÄßÂà´)</label>
                        <div class="flex space-x-4">
                            <label class="flex items-center space-x-2 cursor-pointer bg-white/50 px-4 py-2 rounded-lg border border-slate-200">
                                <input type="radio" name="gender" value="1" checked class="form-radio text-blue-600 h-5 w-5">
                                <span>Male (Áî∑)</span>
                            </label>
                            <label class="flex items-center space-x-2 cursor-pointer bg-white/50 px-4 py-2 rounded-lg border border-slate-200">
                                <input type="radio" name="gender" value="0" class="form-radio text-pink-500 h-5 w-5">
                                <span>Female (Â•≥)</span>
                            </label>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-slate-600 mb-1">Birth Place (Âá∫ÁîüÂú∞)</label>
                        <select id="birthPlace" class="w-full p-3 rounded-lg border border-slate-300 focus:ring-2 focus:ring-indigo-500 outline-none bg-white/50">
                            <option value="KL">Kuala Lumpur / Johor (UTC+8)</option>
                            <option value="PEN">Penang / North</option>
                            <option value="EM">Sabah / Sarawak</option>
                            <option value="INT">International</option>
                        </select>
                    </div>

                    <button type="submit" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-4 rounded-xl shadow-lg transform transition hover:-translate-y-1 mt-4 text-lg">
                        üöÄ Analyze Career Path
                    </button>
                </form>
            </div>

            <div id="resultPanel" class="lg:col-span-8 space-y-6 hidden animate-fade-in" style="animation-delay: 0.4s;">
                
                <div class="glass-card p-6">
                    <h3 class="text-lg font-bold text-slate-700 mb-4">Your BaZi Chart (ÊÇ®ÁöÑÂÖ´Â≠óÂëΩÁõò)</h3>
                    <div class="grid grid-cols-4 gap-3 text-center" id="chartDisplay">
                        </div>
                    <div class="mt-4 p-4 bg-indigo-50/80 border border-indigo-100 rounded-xl text-sm text-indigo-900 text-center flex flex-col items-center">
                        <span class="text-xs uppercase tracking-wider mb-1 text-indigo-400">Your Core Element</span>
                        <div>
                            <strong>Day Master (Êó•‰∏ª):</strong> <span id="dayMasterDisplay" class="font-bold text-2xl ml-2">--</span>
                        </div>
                    </div>
                </div>

                <div class="glass-card p-0 overflow-hidden">
                    <div class="bg-gradient-to-r from-amber-400 to-orange-500 p-4 text-white relative overflow-hidden">
                        <div class="absolute right-0 top-0 opacity-20 transform translate-x-1/3 -translate-y-1/3">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-32 w-32" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd" /></svg>
                        </div>
                        <h3 class="text-xl font-bold flex items-center relative z-10">
                            <span class="text-2xl mr-2">ü§ù</span> Billionaire Match (ÊàêÂäü‰∫∫Â£´ÂåπÈÖç)
                        </h3>
                        <p class="text-white/90 text-sm relative z-10">Based on algorithmic similarity of Element Structure</p>
                    </div>
                    <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-6 items-center bg-white/50">
                        <div class="md:col-span-2 space-y-2">
                            <div class="flex items-baseline space-x-3">
                                <h2 class="text-4xl font-extrabold text-slate-800" id="matchName">Name</h2>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold uppercase" id="matchIndustry">Industry</span>
                                <span class="text-slate-500 text-sm" id="matchBio">Source...</span>
                            </div>
                            
                            <div class="mt-4">
                                <div class="flex justify-between text-sm mb-1 font-semibold">
                                    <span>Similarity Score</span>
                                    <span class="text-amber-600"><span id="matchScoreVal">0</span>% Match</span>
                                </div>
                                <div class="w-full bg-slate-200 rounded-full h-3">
                                    <div id="matchScoreBar" class="bg-gradient-to-r from-amber-400 to-orange-500 h-3 rounded-full transition-all duration-1000 shadow-sm" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-slate-50/80 p-4 rounded-xl border border-slate-200 text-center shadow-sm">
                            <div class="text-sm text-slate-500 font-semibold mb-3 border-b pb-2">Why this match?</div>
                            <div class="text-xs text-left space-y-2 text-slate-600">
                                <p class="flex items-center"><svg class="h-4 w-4 text-green-500 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg> Similar Element Flow</p>
                                <p class="flex items-center"><svg class="h-4 w-4 text-green-500 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg> Compatible Day Master Structure</p>
                                <p class="flex items-center"><svg class="h-4 w-4 text-green-500 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg> Proven Success Path Template</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="glass-card p-6">
                        <h3 class="text-lg font-bold text-slate-700 mb-4 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" /></svg>
                            Recommended Paths
                        </h3>
                        <div id="careerList" class="space-y-3">
                            </div>
                    </div>

                    <div class="glass-card p-6">
                        <h3 class="text-lg font-bold text-slate-700 mb-2 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" /></svg>
                            Elemental Energy Radar
                        </h3>
                        <div class="p-2 bg-white/50 rounded-xl">
                             <canvas id="radarChart"></canvas>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // --- 1. DATASET: Ê®°ÊãüÂêéÂè∞Êï∞ÊçÆÂ∫ì ---
        const billionaireDatabase = [
            { name: "Elon Musk", industry: "Technology", source: "Tesla, SpaceX", elements: [1, 2, 1, 3, 1], dayMaster: "Wood" },
            { name: "Bernard Arnault", industry: "Fashion & Retail", source: "LVMH", elements: [2, 1, 3, 1, 1], dayMaster: "Water" },
            { name: "Jeff Bezos", industry: "Technology", source: "Amazon", elements: [1, 1, 2, 3, 1], dayMaster: "Metal" },
            { name: "Warren Buffett", industry: "Finance", source: "Berkshire Hathaway", elements: [1, 1, 3, 2, 1], dayMaster: "Water" },
            { name: "Bill Gates", industry: "Technology", source: "Microsoft", elements: [1, 2, 1, 1, 3], dayMaster: "Water" },
            { name: "Mark Zuckerberg", industry: "Technology", source: "Facebook", elements: [2, 2, 2, 1, 1], dayMaster: "Earth" },
            { name: "Larry Ellison", industry: "Technology", source: "Software", elements: [1, 3, 1, 2, 1], dayMaster: "Fire" },
            { name: "Mukesh Ambani", industry: "Diversified", source: "Petrochemicals", elements: [2, 2, 3, 0, 1], dayMaster: "Earth" },
            { name: "Zhang Yiming", industry: "Media", source: "TikTok", elements: [1, 1, 1, 2, 3], dayMaster: "Metal" },
            { name: "Ma Huateng", industry: "Technology", source: "Internet Media", elements: [2, 1, 1, 3, 1], dayMaster: "Wood" },
            { name: "Jack Ma", industry: "Technology", source: "E-commerce", elements: [1, 2, 2, 2, 1], dayMaster: "Water" }
        ];

        // Ë°å‰∏öÁâπÂæÅ
        const industries = [
            { name: "Tech & Innovation (ÁßëÊäÄ)", code: "Fire/Metal", profile: [1, 4, 1, 3, 1], desc: "Requires innovation (Fire) and execution (Metal)." },
            { name: "Real Estate & Resources (ÊàøÂú∞‰∫ß)", code: "Earth", profile: [1, 1, 5, 1, 0], desc: "Requires stability and trust (Earth)." },
            { name: "Finance & Investment (ÈáëËûç)", code: "Metal/Water", profile: [0, 1, 2, 4, 2], desc: "Requires precision (Metal) and flow (Water)." },
            { name: "Media & Arts (‰º†Â™í)", code: "Fire/Wood", profile: [3, 4, 0, 1, 1], desc: "Requires creativity (Wood) and visibility (Fire)." },
            { name: "Logistics & Trade (Ë¥∏Êòì)", code: "Water", profile: [1, 1, 1, 2, 4], desc: "Requires movement and wisdom (Water)." }
        ];

        // --- 2. HELPER: ‰∫îË°åÊò†Â∞Ñ ---
        const elementMap = {
            'Áî≤': 0, '‰πô': 0, 'ÂØÖ': 0, 'ÂçØ': 0,
            '‰∏ô': 1, '‰∏Å': 1, 'Â∑≥': 1, 'Âçà': 1,
            'Êàä': 2, 'Â∑±': 2, 'Ëæ∞': 2, 'Êàå': 2, '‰∏ë': 2, 'Êú™': 2,
            'Â∫ö': 3, 'Ëæõ': 3, 'Áî≥': 3, 'ÈÖâ': 3,
            'Â£¨': 4, 'Áô∏': 4, '‰∫•': 4, 'Â≠ê': 4
        };
        
        const elementColors = ['#4caf50', '#f44336', '#ff9800', '#9e9e9e', '#2196f3'];
        const elementNames = ['Wood (Êú®)', 'Fire (ÁÅ´)', 'Earth (Âúü)', 'Metal (Èáë)', 'Water (Ê∞¥)'];

        let myChart = null;

        // --- 3. MAIN LOGIC: ÂàÜÊûêÂáΩÊï∞ ---
        function analyzeProfile() {
            const dateStr = document.getElementById('birthDate').value;
            const timeStr = document.getElementById('birthTime').value;
            
            if (!dateStr || !timeStr) { alert("Please fill in all fields."); return; }

            // Lunar.js ÊéíÁõò
            const dateParts = dateStr.split('-');
            const timeParts = timeStr.split(':');
            const solar = Solar.fromYmdHms(parseInt(dateParts[0]), parseInt(dateParts[1]), parseInt(dateParts[2]), parseInt(timeParts[0]), parseInt(timeParts[1]), 0);
            const lunar = solar.getLunar();
            const bazi = lunar.getEightChar();
            
            const pillars = {
                yS: bazi.getYearGan(), yB: bazi.getYearZhi(),
                mS: bazi.getMonthGan(), mB: bazi.getMonthZhi(),
                dS: bazi.getDayGan(), dB: bazi.getDayZhi(),
                hS: bazi.getTimeGan(), hB: bazi.getTimeZhi()
            };

            // ËÆ°ÁÆóÂêëÈáè
            const allChars = [pillars.yS, pillars.yB, pillars.mS, pillars.mB, pillars.dS, pillars.dB, pillars.hS, pillars.hB];
            const userVector = [0, 0, 0, 0, 0];
            allChars.forEach(char => { const type = elementMap[char]; if (type !== undefined) userVector[type]++; });

            const dayMasterVal = elementMap[pillars.dS];
            const dayMasterName = elementNames[dayMasterVal];

            // ÊòæÁ§∫ÁªìÊûú
            renderChartDisplay(pillars);
            document.getElementById('dayMasterDisplay').innerHTML = `<span style="color:${elementColors[dayMasterVal]}">${dayMasterName}</span>`;

            const match = findBillionaireMatch(userVector, dayMasterName);
            renderMatch(match);
            recommendCareer(userVector);
            renderRadarChart(userVector);

            const resultPanel = document.getElementById('resultPanel');
            resultPanel.classList.remove('hidden');
            setTimeout(() => resultPanel.scrollIntoView({ behavior: 'smooth', block: 'start' }), 100);
        }

        // --- Helper Functions ---
        function renderChartDisplay(p) {
            const container = document.getElementById('chartDisplay');
            const labels = ['Year Pillar', 'Month Pillar', 'Day Pillar', 'Hour Pillar'];
            const stems = [p.yS, p.mS, p.dS, p.hS];
            const branches = [p.yB, p.mB, p.dB, p.hB];
            let html = '';
            for(let i=0; i<4; i++) {
                const sColor = getColorClass(stems[i]);
                const bColor = getColorClass(branches[i]);
                html += `
                    <div class="bg-white/80 p-3 rounded-xl shadow-sm border border-slate-100 flex flex-col items-center ${i===2 ? 'ring-2 ring-indigo-200 bg-indigo-50/50' : ''}">
                        <div class="text-[10px] uppercase tracking-wider text-slate-400 mb-2">${labels[i]}</div>
                        <div class="text-2xl font-black ${sColor} leading-none mb-1">${stems[i]}</div>
                        <div class="text-2xl font-black ${bColor} leading-none">${branches[i]}</div>
                    </div>
                `;
            }
            container.innerHTML = html;
        }

        function getColorClass(char) {
            const type = elementMap[char];
            if(type === 0) return 'wood-text'; if(type === 1) return 'fire-text';
            if(type === 2) return 'earth-text'; if(type === 3) return 'metal-text';
            if(type === 4) return 'water-text'; return 'text-gray-800';
        }

        function cosineSim(vecA, vecB) {
            let dot = 0, normA = 0, normB = 0;
            for(let i=0; i<5; i++) { dot += vecA[i] * vecB[i]; normA += vecA[i]**2; normB += vecB[i]**2; }
            return dot / (Math.sqrt(normA) * Math.sqrt(normB) || 1);
        }

        function findBillionaireMatch(userVec, userDM) {
            let bestMatch = null, highestScore = -1;
            billionaireDatabase.forEach(bill => {
                let score = cosineSim(userVec, bill.elements);
                if (userDM.startsWith(bill.dayMaster)) score += 0.15;
                if (score > highestScore) { highestScore = score; bestMatch = bill; }
            });
            return { ...bestMatch, score: highestScore };
        }

        function renderMatch(match) {
            document.getElementById('matchName').innerText = match.name;
            document.getElementById('matchIndustry').innerText = match.industry;
            document.getElementById('matchBio').innerText = match.source;
            const pct = Math.min(Math.round(match.score * 100), 98);
            document.getElementById('matchScoreVal').innerText = pct;
            document.getElementById('matchScoreBar').style.width = `${pct}%`;
        }

        function recommendCareer(userVec) {
            let scoredIndustries = industries.map(ind => ({ ...ind, score: cosineSim(userVec, ind.profile) }));
            scoredIndustries.sort((a,b) => b.score - a.score);
            const list = document.getElementById('careerList');
            list.innerHTML = '';
            scoredIndustries.slice(0, 3).forEach((ind, i) => {
                list.innerHTML += `
                    <div class="flex items-center justify-between bg-white/80 p-3 rounded-xl border border-slate-100 hover:shadow-md transition group">
                        <div>
                            <div class="font-bold text-slate-800 group-hover:text-indigo-600 transition">#${i+1} ${ind.name}</div>
                            <div class="text-xs text-slate-500">${ind.desc}</div>
                        </div>
                        <div class="text-indigo-600 font-black text-lg">${Math.round(ind.score*100)}<span class="text-sm">%</span></div>
                    </div>
                `;
            });
        }

        function renderRadarChart(data) {
            const ctx = document.getElementById('radarChart').getContext('2d');
            if(myChart) myChart.destroy();
            myChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: elementNames.map(n => n.split(' ')[1]),
                    datasets: [{
                        label: 'Energy Structure',
                        data: data,
                        backgroundColor: 'rgba(99, 102, 241, 0.2)',
                        borderColor: 'rgba(99, 102, 241, 1)',
                        pointBackgroundColor: 'rgba(99, 102, 241, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    scales: { r: { angleLines: {color:'rgba(0,0,0,0.05)'}, grid: {color:'rgba(0,0,0,0.05)'}, suggestedMin: 0, suggestedMax: 4, ticks: { display: false } } },
                    plugins: { legend: { display: false } },
                    maintainAspectRatio: false
                }
            });
        }
    </script>
</body>
</html>